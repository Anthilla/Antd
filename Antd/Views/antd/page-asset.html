@Master['layout.html']
<!-------------------------------------------------------------------------------------
//     Copyright (c) 2014, Anthilla S.r.l. (http://www.anthilla.com)
//     All rights reserved.
//
//     Redistribution and use in source and binary forms, with or without
//     modification, are permitted provided that the following conditions are met:
//         * Redistributions of source code must retain the above copyright
//           notice, this list of conditions and the following disclaimer.
//         * Redistributions in binary form must reproduce the above copyright
//           notice, this list of conditions and the following disclaimer in the
//           documentation and/or other materials provided with the distribution.
//         * Neither the name of the Anthilla S.r.l. nor the
//           names of its contributors may be used to endorse or promote products
//           derived from this software without specific prior written permission.
//
//     THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND
//     ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED
//     WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE
//     DISCLAIMED. IN NO EVENT SHALL ANTHILLA S.R.L. BE LIABLE FOR ANY
//     DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES
//     (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;
//     LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND
//     ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT
//     (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS
//     SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.
//
//     20141110
//------------------------------------------------------------------------------------->
@Section['PageBar']
<style type="text/css">
    #Asset-TB {
        background-color: #A7BD39 !important;
        border-color: #A7BD39 !important;
        color: #3a3a3a !important;
    }

    #Asset-TB *{
        color: #3a3a3a !important;
    }

    div.row {
        margin-top: 20px !important;
    }

    #BottomContent {
        padding: 0 !important;
        border-top-color: #3a3a3a;
        border-top-width: 4px;
    }
</style>
@EndSection

@Section['MainContent']
@Partial['antd/page-asset-discovery', Model];
@EndSection

@Section['Scripts']
<script data-context="asset" type="text/javascript">
    var $asset = jQuery.noConflict();

    $asset('[data-role="ShareSshKeys"]').click(function () {
        var ip = $asset(this).attr('data-ip');
        var port = $asset(this).attr('data-port');
        jQuery.support.cors = true;
        var aj = $asset.ajax({
            url: "/asset/handshake?host=" + ip + "&port=" + port,
            type: "GET",
            success: function () {
                alert("Key shared successfully!");
            }
        });
        _requests.push(aj);
    });

    $asset('[data-role="ShowNmap"]').click(function () {
        var btn = $asset(this);
        var ip = $asset(this).attr('data-ip');
        var cont = $asset(this).parents('.panel-content').find('[data-role="NmapResult"]');
        jQuery.support.cors = true;
        var aj = $asset.ajax({
            url: "/asset/nmap/" + ip,
            type: "GET",
            success: function (data) {
                $asset.each(data, function (k, v) {
                    cont.append("<tr>" + "<td class=\"bg-gray\">" + v.protocol + "</td>" +
                        "<td class=\"bg-gray\">" + v.status + "</td>" +
                        "<td class=\"bg-gray\">" + v.type + "</td>" + "</tr>");
                });
                cont.parents('table').show();
                btn.hide();
            }
        });
        _requests.push(aj);
    });

    $asset('[data-role="Wol"]').click(function () {
        var mac = $asset(this).attr('data-mac');
        jQuery.support.cors = true;
        var aj = $asset.ajax({
            url: "/asset/wol/" + mac,
            type: "GET",
            success: function () {
            }
        });
        _requests.push(aj);
    });

    function SetConnectionLink() {
        var host = $asset('#NoVncHost').val();
        var port = $asset('#NoVncPort').val();
        $asset("#NoVncConnect").attr("href", "?host=" + host + "&port=" + port);
    }

    $asset('input[data-role="novnc-setup"]').keyup(function () {
        SetConnectionLink();
    });
</script>
@EndSection
