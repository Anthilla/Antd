<html>
<head><link rel='stylesheet' type='text/css' href='/default.css'>
<title>Imported Certificates</title>
<script>
function importCertificate() {
  document.data.Action.value="ImportCertificate";
  document.data.submit();
}
function view() {
  if (document.data.Imported.selectedIndex>-1) {
    newwin=open("kerbynet?Section=x509&STk=<xvar STk>&Action=ViewCert&Type=Imported&Cert="+document.data.Imported.value,"x509viewtext","top=120,left=220,width=750,height=500,scrollbars=yes,menubar=no,toolbar=no,statusbar=no");
    newwin.focus();
  } else {
    alert("You have to select a certificate to view.");
  }
}
function Remove() {
   if (document.data.Imported.selectedIndex>-1) {
     if (document.data.Imported.options[document.data.Imported.selectedIndex].value==".default") {
       alert("You cannot remove the autogenerated certificate.");
       return;
     }
     if (confirm("Are you sure you want to remove the selected certificate?")) {
       document.data.Action.value="DeleteImported";
       document.data.submit();
     }
   } else {
     alert("You have to select a certificate to remove.");
   }
}
function x509export() {
    if (document.data.Imported.selectedIndex>-1) { 
      document.data.Action.value="ExportImported";
      document.data.submit();
    } else {
      alert("You have to select a certificate to export.");
    }
}
function clickKeyFormat() {
   if (document.data.IncludeKey.checked && document.data.Format.value=="der") {
      alert("<xvar #X509WarningDerKey>");
      document.data.IncludeKey.checked=false;
   };
}
function RefreshOpener() {
  var WO=window.opener;
  if (WO!=null) {
    if (!WO.closed) {
      if (WO.document.title=="Radius Management" || WO.document.title=="VPN X509" || WO.document.title=="L2TP" || WO.document.title=="CP X509" || WO.document.title=="HTTPS X509" || WO.document.title=="LDAP X509") {
        WO.Refresh();
      }
    }
  }
}
</script>
</head>
<body>
<form name=data method=post action="kerbynet" enctype="multipart/form-data">
<input type=hidden name=Section value='x509'>
<input type=hidden name=Action value=''><input type=hidden name=STk value=<xvar STk>>
<input type=hidden name=x509type value='Imported'>
<table width=100%>
<tr><td>
<font color="#0000c0" class=Bigger2><b>Imported Certificates and Keys</b></font>
</td><td align=right>
<input type=button value=" View " onclick="view()">
<input type=button value=Export onclick="x509export()">
<input type=checkbox name=IncludeKey value=Yes checked onclick="clickKeyFormat()"> Key
<select name=Format onchange="clickKeyFormat()">
<option value=pem selected>PEM</option>
<option value=der>DER</option>
<option value=pfx>PKCS#12 (PFX)</option>
</select>
<input type=button value="Remove" onclick="Remove()">
<input type=button value=" Close " onclick="window.close()">
</td></tr>
</table>
<hr>
<table width=100%>
<tr>
<td>
<font color=#0000D0>Imported certificate list</font><br>
<select name=Imported size=18 style="width: 100%" onDblClick="view()">
<xvar !listImportedCerts>
</select>
</td>
</tr>
<tr>
<td align=center nowrap>
<hr>
Certificate <input type=file name=CertImport>&nbsp;&nbsp;
Key <input type=file name=KeyImport>&nbsp;&nbsp;&nbsp;
<input type=button value="Import" onclick="importCertificate()">
</td>
</tr>
</table>
<hr>
<font color="#FF0000"><xvar errormsg></font>
</form>
</body>
</html>
